{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///D:/haseeb/Projects/dashboard/src/lib/auth-server.ts"],"sourcesContent":["import bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport { parse, serialize } from \"cookie\";\nimport { NextRequest, NextResponse } from \"next/server\";\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"nexus-dashboard-secret-key-change-in-prod\";\nconst COOKIE_NAME = \"nexus_token\";\n\n// ─── In-memory user store (replace with DB in production) ───\nexport interface User {\n  id: string;\n  email: string;\n  name: string;\n  passwordHash: string;\n  role: \"admin\" | \"analyst\" | \"viewer\";\n  createdAt: string;\n}\n\nconst users: User[] = [];\n\n// Seed default admin\n(async () => {\n  const hash = await bcrypt.hash(\"admin123\", 10);\n  users.push({\n    id: \"1\",\n    email: \"admin@nexus.io\",\n    name: \"Alex Morgan\",\n    passwordHash: hash,\n    role: \"admin\",\n    createdAt: new Date().toISOString(),\n  });\n})();\n\n// ─── User CRUD ───\nexport function findByEmail(email: string): User | undefined {\n  return users.find((u) => u.email.toLowerCase() === email.toLowerCase());\n}\n\nexport async function createUser(email: string, name: string, password: string): Promise<User> {\n  if (findByEmail(email)) throw new Error(\"User already exists\");\n  const hash = await bcrypt.hash(password, 10);\n  const user: User = {\n    id: String(Date.now()),\n    email,\n    name,\n    passwordHash: hash,\n    role: users.length === 0 ? \"admin\" : \"analyst\",\n    createdAt: new Date().toISOString(),\n  };\n  users.push(user);\n  return user;\n}\n\nexport async function verifyPassword(plain: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(plain, hash);\n}\n\n// ─── JWT ───\nexport function signToken(userId: string, email: string): string {\n  return jwt.sign({ userId, email }, JWT_SECRET, { expiresIn: \"7d\" });\n}\n\nexport function verifyToken(token: string): { userId: string; email: string } | null {\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET) as { userId: string; email: string };\n    return decoded;\n  } catch {\n    return null;\n  }\n}\n\n// ─── Cookie helpers ───\nexport function setAuthCookie<T>(res: NextResponse<T>, token: string): NextResponse<T> {\n  res.cookies.set(COOKIE_NAME, token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    path: \"/\",\n    maxAge: 60 * 60 * 24 * 7, // 7 days\n  });\n  return res;\n}\n\nexport function clearAuthCookie<T>(res: NextResponse<T>): NextResponse<T> {\n  res.cookies.set(COOKIE_NAME, \"\", { maxAge: 0, path: \"/\" });\n  return res;\n}\n\nexport function getTokenFromRequest(req: NextRequest): string | null {\n  const cookieHeader = req.headers.get(\"cookie\");\n  if (!cookieHeader) return null;\n  const cookies = parse(cookieHeader);\n  return cookies[COOKIE_NAME] || null;\n}\n\n// ─── Auth middleware helper ───\nexport function authenticateRequest(req: NextRequest): { user: User } | { error: string } {\n  const token = getTokenFromRequest(req);\n  if (!token) return { error: \"No token\" };\n  const payload = verifyToken(token);\n  if (!payload) return { error: \"Invalid token\" };\n  const user = users.find((u) => u.id === payload.userId);\n  if (!user) return { error: \"User not found\" };\n  return { user };\n}\n\nexport function sanitizeUser(user: User) {\n  const { passwordHash, ...safe } = user;\n  return safe;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;;;;AAGA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC7C,MAAM,cAAc;AAYpB,MAAM,QAAgB,EAAE;AAExB,qBAAqB;AACrB,CAAC;IACC,MAAM,OAAO,MAAM,8IAAM,CAAC,IAAI,CAAC,YAAY;IAC3C,MAAM,IAAI,CAAC;QACT,IAAI;QACJ,OAAO;QACP,MAAM;QACN,cAAc;QACd,MAAM;QACN,WAAW,IAAI,OAAO,WAAW;IACnC;AACF,CAAC;AAGM,SAAS,YAAY,KAAa;IACvC,OAAO,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,KAAK,CAAC,WAAW,OAAO,MAAM,WAAW;AACtE;AAEO,eAAe,WAAW,KAAa,EAAE,IAAY,EAAE,QAAgB;IAC5E,IAAI,YAAY,QAAQ,MAAM,IAAI,MAAM;IACxC,MAAM,OAAO,MAAM,8IAAM,CAAC,IAAI,CAAC,UAAU;IACzC,MAAM,OAAa;QACjB,IAAI,OAAO,KAAK,GAAG;QACnB;QACA;QACA,cAAc;QACd,MAAM,MAAM,MAAM,KAAK,IAAI,UAAU;QACrC,WAAW,IAAI,OAAO,WAAW;IACnC;IACA,MAAM,IAAI,CAAC;IACX,OAAO;AACT;AAEO,eAAe,eAAe,KAAa,EAAE,IAAY;IAC9D,OAAO,8IAAM,CAAC,OAAO,CAAC,OAAO;AAC/B;AAGO,SAAS,UAAU,MAAc,EAAE,KAAa;IACrD,OAAO,kJAAG,CAAC,IAAI,CAAC;QAAE;QAAQ;IAAM,GAAG,YAAY;QAAE,WAAW;IAAK;AACnE;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,MAAM,UAAU,kJAAG,CAAC,MAAM,CAAC,OAAO;QAClC,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAGO,SAAS,cAAiB,GAAoB,EAAE,KAAa;IAClE,IAAI,OAAO,CAAC,GAAG,CAAC,aAAa,OAAO;QAClC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,MAAM;QACN,QAAQ,KAAK,KAAK,KAAK;IACzB;IACA,OAAO;AACT;AAEO,SAAS,gBAAmB,GAAoB;IACrD,IAAI,OAAO,CAAC,GAAG,CAAC,aAAa,IAAI;QAAE,QAAQ;QAAG,MAAM;IAAI;IACxD,OAAO;AACT;AAEO,SAAS,oBAAoB,GAAgB;IAClD,MAAM,eAAe,IAAI,OAAO,CAAC,GAAG,CAAC;IACrC,IAAI,CAAC,cAAc,OAAO;IAC1B,MAAM,UAAU,IAAA,kJAAK,EAAC;IACtB,OAAO,OAAO,CAAC,YAAY,IAAI;AACjC;AAGO,SAAS,oBAAoB,GAAgB;IAClD,MAAM,QAAQ,oBAAoB;IAClC,IAAI,CAAC,OAAO,OAAO;QAAE,OAAO;IAAW;IACvC,MAAM,UAAU,YAAY;IAC5B,IAAI,CAAC,SAAS,OAAO;QAAE,OAAO;IAAgB;IAC9C,MAAM,OAAO,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,QAAQ,MAAM;IACtD,IAAI,CAAC,MAAM,OAAO;QAAE,OAAO;IAAiB;IAC5C,OAAO;QAAE;IAAK;AAChB;AAEO,SAAS,aAAa,IAAU;IACrC,MAAM,EAAE,YAAY,EAAE,GAAG,MAAM,GAAG;IAClC,OAAO;AACT"}},
    {"offset": {"line": 197, "column": 0}, "map": {"version":3,"sources":["file:///D:/haseeb/Projects/dashboard/src/app/api/stats/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { authenticateRequest } from \"@/lib/auth-server\";\n\n// ─── Deterministic pseudo-random (seeded) ───\nfunction seededRandom(seed: number): () => number {\n  let s = seed;\n  return () => {\n    s = (s * 1664525 + 1013904223) & 0x7fffffff;\n    return s / 0x7fffffff;\n  };\n}\n\nfunction generateStats() {\n  const rand = seededRandom(42);\n  const months = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n\n  // Revenue & visitors over 12 months\n  const revenueData = months.map((month, i) => {\n    const base = 30000 + i * 4500;\n    return {\n      month,\n      revenue: Math.round(base + (rand() - 0.3) * 12000),\n      visitors: Math.round(8000 + i * 1200 + (rand() - 0.4) * 3000),\n      conversions: Math.round(1200 + i * 200 + (rand() - 0.35) * 600),\n    };\n  });\n\n  // Traffic sources (pie)\n  const trafficSources = [\n    { name: \"Organic Search\", value: 38, color: \"#06b6d4\" },\n    { name: \"Direct\", value: 25, color: \"#8b5cf6\" },\n    { name: \"Social Media\", value: 18, color: \"#10b981\" },\n    { name: \"Referral\", value: 12, color: \"#f59e0b\" },\n    { name: \"Email\", value: 7, color: \"#f43f5e\" },\n  ];\n\n  // Weekly active hours heatmap (7 days × 24 hours)\n  const activityHeatmap = Array.from({ length: 7 }, (_, day) =>\n    Array.from({ length: 24 }, (_, hour) => {\n      const peak = hour >= 9 && hour <= 17 ? 1 : 0.3;\n      const weekend = day >= 5 ? 0.5 : 1;\n      return Math.round((rand() * 60 + 10) * peak * weekend);\n    })\n  );\n\n  // Recent users table\n  const names = [\"Sofia Chen\",\"Raj Patel\",\"Emma Wilson\",\"Lucas Martin\",\"Aisha Khan\",\"Noah Davis\",\"Mia Thompson\",\"Oliver Wright\",\"Zara Ali\",\"Ethan Clark\"];\n  const roles = [\"Admin\",\"Analyst\",\"Viewer\"];\n  const statuses = [\"Active\",\"Active\",\"Active\",\"Idle\",\"Active\",\"Away\"];\n  const recentUsers = names.map((name, i) => ({\n    id: i + 1,\n    name,\n    email: `${name.split(\" \")[0].toLowerCase()}@nexus.io`,\n    role: roles[i % roles.length],\n    status: statuses[i % statuses.length],\n    lastActive: `${Math.floor(rand() * 60)} min ago`,\n  }));\n\n  // KPI cards\n  const totalRevenue = revenueData.reduce((s, d) => s + d.revenue, 0);\n  const totalVisitors = revenueData.reduce((s, d) => s + d.visitors, 0);\n  const totalConversions = revenueData.reduce((s, d) => s + d.conversions, 0);\n  const conversionRate = ((totalConversions / totalVisitors) * 100).toFixed(1);\n\n  return {\n    kpis: [\n      { label: \"Total Revenue\", value: `$${(totalRevenue / 1000).toFixed(0)}K`, change: 12.5, trend: \"up\" },\n      { label: \"Total Visitors\", value: `${(totalVisitors / 1000).toFixed(0)}K`, change: 8.2, trend: \"up\" },\n      { label: \"Conversions\", value: `${(totalConversions / 1000).toFixed(1)}K`, change: -2.1, trend: \"down\" },\n      { label: \"Conv. Rate\", value: `${conversionRate}%`, change: 0.4, trend: \"up\" },\n    ],\n    revenueData,\n    trafficSources,\n    activityHeatmap,\n    recentUsers,\n  };\n}\n\nexport async function GET(req: NextRequest) {\n  const result = authenticateRequest(req);\n  if (\"error\" in result) return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  return NextResponse.json(generateStats());\n}\n"],"names":[],"mappings":"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"}}]
}